# JavaScript的作用域问题
## 函数的作用域
JavaScript函数的作用域是静态作用域，函数的作用域只与函数被定义的位置有关，与函数被调用的位置无关。
## this的指向
this是在函数被调用时绑定的，this的指向取决于函数的调用位置。调用位置在当前正在执行的函数的前一个调用中。
### this的绑定原则
1. 默认绑定（独立函数调用），this指向全局对象
2. 隐式绑定对象。（调用位置是否有上下文对象）this绑定为函数的调用者。属性引用链中只有最顶层或者说最后一层会影响调用位置
3. 显示绑定，即通过call或apply绑定
4. new绑定：this绑定到使用new创建的对象上。
## 附： 使用new来调用函数时会发生的操作
1. 创建一个新对象
2. 这个新对象会被执行[[原型]]连接
3. 这个新对象会绑定到函数调用的this
4. 如果函数没有返回其他对象，则new表达式中的函数调用会自动返回这个新对象。

例如：当代码 new foo(...) 执行时：

1. 一个新对象被创建。它继承自foo.prototype.
2. 构造函数 foo 被执行。执行的时候，相应的传参会被传入，同时上下文(this)会被指定为这个新实例。new foo 等同于 new foo(), 只能用在不传递任何参数的情况。
3. 这个新对象会绑定到函数调用的this
4. 如果构造函数返回了一个“对象”，那么这个对象会取代整个new出来的结果。如果构造函数没有返回对象，那么new出来的结果为步骤1创建的对象，ps：一般情况下构造函数不返回任何值，不过用户如果想覆盖这个返回值，可以自己选择返回一个普通对象来覆盖。当然，返回数组也会覆盖，因为数组也是对象。
